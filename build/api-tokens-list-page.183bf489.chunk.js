"use strict";(self.webpackChunkstrapi_sqlite=self.webpackChunkstrapi_sqlite||[]).push([[8056],{62177:function(e,t,a){var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(67154)),o=n(a(53547)),r=n(a(62982)),s=a(49549),i=a(94117),u=a(68547),d=a(97132),c=n(a(45697));const f=e=>{let{tokenName:t,onClickDelete:a}=e;const{formatMessage:n}=(0,d.useIntl)(),{trackUsage:c}=(0,u.useTracking)();return o.default.createElement(i.Box,(0,l.default)({paddingLeft:1},u.stopPropagation),o.default.createElement(s.IconButton,{onClick:()=>{c("willDeleteToken"),a()},label:n({id:"global.delete-target",defaultMessage:"Delete {target}"},{target:`${t}`}),noBorder:!0,icon:o.default.createElement(r.default,null)}))};f.propTypes={tokenName:c.default.string.isRequired,onClickDelete:c.default.func.isRequired};var p=f;t.default=p},60014:function(e,t,a){var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(53547)),o=n(a(56204)),r=a(97132),s=n(a(45697)),i=a(56156),u=a(39711);const d=(0,n(a(78384)).default)(i.Link).withConfig({displayName:"UpdateButton__LinkUpdate",componentId:"sc-13tqcqf-0"})(["svg{path{fill:",";}}&:hover{svg{path{fill:",";}}}"],(e=>{let{theme:t}=e;return t.colors.neutral500}),(e=>{let{theme:t}=e;return t.colors.neutral800})),c=e=>{let{tokenName:t,tokenId:a}=e;const{formatMessage:n}=(0,r.useIntl)(),{location:{pathname:s}}=(0,u.useHistory)();return l.default.createElement(d,{to:`${s}/${a}`,title:n({id:"app.component.table.edit",defaultMessage:"Edit {target}"},{target:`${t}`})},l.default.createElement(o.default,null))};c.propTypes={tokenName:s.default.string.isRequired,tokenId:s.default.oneOfType([s.default.string,s.default.number]).isRequired};var f=c;t.default=f},63384:function(e,t,a){var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(67154)),o=n(a(53547)),r=a(33483),s=a(43546),i=a(40264),u=a(68547),d=a(97132),c=n(a(45697)),f=a(39711),p=n(a(62177)),m=n(a(60014));const k=e=>{let{canDelete:t,canUpdate:a,onClickDelete:n,withBulkActions:c,rows:k}=e;const{formatMessage:g}=(0,d.useIntl)(),[{query:y}]=(0,u.useQueryParams)(),[,T]=y.sort.split(":"),{push:v,location:{pathname:E}}=(0,f.useHistory)(),{trackUsage:b}=(0,u.useTracking)(),w=k.sort(((e,t)=>{const a=e.name.localeCompare(t.name);return"DESC"===T?-a:a}));return o.default.createElement(s.Tbody,null,w.map((e=>o.default.createElement(s.Tr,(0,l.default)({key:e.id},(0,u.onRowClick)({fn:()=>{b("willEditTokenFromList"),v(`${E}/${e.id}`)},condition:a})),o.default.createElement(s.Td,null,o.default.createElement(r.Typography,{textColor:"neutral800",fontWeight:"bold"},e.name)),o.default.createElement(s.Td,{maxWidth:(0,u.pxToRem)(250)},o.default.createElement(r.Typography,{textColor:"neutral800",ellipsis:!0},e.description)),o.default.createElement(s.Td,null,o.default.createElement(r.Typography,{textColor:"neutral800"},g({id:`Settings.apiTokens.types.${e.type}`,defaultMessage:"Type unknown"}))),o.default.createElement(s.Td,null,o.default.createElement(r.Typography,{textColor:"neutral800"},o.default.createElement(u.RelativeTime,{timestamp:new Date(e.createdAt)}))),c&&o.default.createElement(s.Td,null,o.default.createElement(i.Flex,{justifyContent:"end"},a&&o.default.createElement(m.default,{tokenName:e.name,tokenId:e.id}),t&&o.default.createElement(p.default,{tokenName:e.name,onClickDelete:()=>n(e.id)})))))))};k.defaultProps={canDelete:!1,canUpdate:!1,onClickDelete:()=>{},rows:[],withBulkActions:!1},k.propTypes={canDelete:c.default.bool,canUpdate:c.default.bool,onClickDelete:c.default.func,rows:c.default.array,withBulkActions:c.default.bool};var g=k;t.default=g},65954:function(e,t,a){var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var a=v(t);if(a&&a.has(e))return a.get(e);var n={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var r=l?Object.getOwnPropertyDescriptor(e,o):null;r&&(r.get||r.set)?Object.defineProperty(n,o,r):n[o]=e[o]}n.default=e,a&&a.set(e,n);return n}(a(53547)),o=a(97132),r=a(68547),s=a(35395),i=a(80117),u=a(64459),d=a(31512),c=n(a(89326)),f=a(23724),p=a(39711),m=n(a(80129)),k=a(53777),g=n(a(13240)),y=n(a(9070)),T=n(a(63384));function v(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(v=function(e){return e?a:t})(e)}var E=()=>{(0,r.useFocusWhenNavigate)();const e=(0,f.useQueryClient)(),{formatMessage:t}=(0,o.useIntl)(),a=(0,r.useNotification)(),{allowedActions:{canCreate:n,canDelete:v,canUpdate:E,canRead:b}}=(0,r.useRBAC)(g.default.settings["api-tokens"]),{push:w}=(0,p.useHistory)(),{trackUsage:h}=(0,r.useTracking)(),{startSection:C}=(0,r.useGuidedTour)(),M=(0,l.useRef)(C);(0,l.useEffect)((()=>{M.current&&M.current("apiTokens")}),[]),(0,l.useEffect)((()=>{w({search:m.default.stringify({sort:"name:ASC"},{encode:!1})})}),[w]);const{data:A,status:P,isFetching:D}=(0,f.useQuery)(["api-tokens"],(async()=>{h("willAccessTokenList");const{data:{data:e}}=await k.axiosInstance.get("/admin/api-tokens");return h("didAccessTokenList",{number:e.length}),e}),{enabled:b,onError:()=>{a({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}}),I=b&&("success"!==P&&"error"!==P||"success"===P&&D),_=(0,f.useMutation)((async e=>{await k.axiosInstance.delete(`/admin/api-tokens/${e}`)}),{onSuccess:async()=>{await e.invalidateQueries(["api-tokens"]),h("didDeleteToken")},onError:e=>{var t,n;null!==e&&void 0!==e&&null!==(t=e.response)&&void 0!==t&&null!==(n=t.data)&&void 0!==n&&n.data?a({type:"warning",message:e.response.data.data}):a({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}}),O=b&&A,L=b&&!A&&!n,N=b&&!A&&n;return l.default.createElement(i.Main,{"aria-busy":I},l.default.createElement(r.SettingsPageTitle,{name:"API Tokens"}),l.default.createElement(s.HeaderLayout,{title:t({id:"Settings.apiTokens.title",defaultMessage:"API Tokens"}),subtitle:t({id:"Settings.apiTokens.description",defaultMessage:"List of generated tokens to consume the API"}),primaryAction:n?l.default.createElement(d.LinkButton,{"data-testid":"create-api-token-button",startIcon:l.default.createElement(c.default,null),size:"L",onClick:()=>h("willAddTokenFromList"),to:"/settings/api-tokens/create"},t({id:"Settings.apiTokens.create",defaultMessage:"Create new API Token"})):void 0}),l.default.createElement(s.ContentLayout,null,!b&&l.default.createElement(r.NoPermissions,null),O&&l.default.createElement(r.DynamicTable,{headers:y.default,contentType:"api-tokens",rows:A,withBulkActions:v||E,isLoading:I,onConfirmDelete:e=>_.mutateAsync(e)},l.default.createElement(T.default,{canDelete:v,canUpdate:E,rows:A,withBulkActions:v||E})),N&&l.default.createElement(r.NoContent,{content:{id:"Settings.apiTokens.addFirstToken",defaultMessage:"Add your first API Token"},action:l.default.createElement(u.Button,{variant:"secondary",startIcon:l.default.createElement(c.default,null)},t({id:"Settings.apiTokens.addNewToken",defaultMessage:"Add new API Token"}))}),L&&l.default.createElement(r.NoContent,{content:{id:"Settings.apiTokens.emptyStateLayout",defaultMessage:"You don\u2019t have any content yet..."}})))};t.default=E},9070:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=[{name:"name",key:"name",metadatas:{label:"Name",sortable:!0}},{name:"description",key:"description",metadatas:{label:"Description",sortable:!1}},{name:"type",key:"type",metadatas:{label:"Token type",sortable:!1}},{name:"createdAt",key:"createdAt",metadatas:{label:"Created at",sortable:!1}}];t.default=a},76796:function(e,t,a){var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(53547)),o=a(68547),r=n(a(13240)),s=n(a(65954));var i=()=>l.default.createElement(o.CheckPagePermissions,{permissions:r.default.settings["api-tokens"].main},l.default.createElement(s.default,null));t.default=i}}]);