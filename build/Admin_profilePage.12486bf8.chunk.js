"use strict";(self.webpackChunkstrapi_sqlite=self.webpackChunkstrapi_sqlite||[]).push([[9497],{74748:function(e,t,a){var r=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var a=C(t);if(a&&a.has(e))return a.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var o=n?Object.getOwnPropertyDescriptor(e,l):null;o&&(o.get||o.set)?Object.defineProperty(r,l,o):r[l]=e[l]}r.default=e,a&&a.set(e,r);return r}(a(53547)),l=r(a(78384)),o=a(68547),s=a(97132),i=a(80831),u=r(a(11700)),d=a(23724),f=r(a(78718)),c=a(15482),p=a(80117),m=a(33483),g=a(94117),h=a(35395),w=a(64459),y=a(39272),v=a(9524),b=a(67422),E=a(2632),M=a(16572),P=a(99136),O=r(a(31023)),j=r(a(52973)),S=r(a(22754)),k=r(a(92651)),_=a(63376),I=a(91871),L=r(a(32860)),x=a(26595);function C(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(C=function(e){return e?a:t})(e)}const A=l.default.a.withConfig({displayName:"ProfilePage__DocumentationLink",componentId:"sc-1fhx3cm-0"})(["color:",";"],(e=>{let{theme:t}=e;return t.colors.primary600})),T=(0,l.default)(P.TextInput).withConfig({displayName:"ProfilePage__PasswordInput",componentId:"sc-1fhx3cm-1"})(["::-ms-reveal{display:none;}"]),G=(0,l.default)(M.FieldAction).withConfig({displayName:"ProfilePage__FieldActionWrapper",componentId:"sc-1fhx3cm-2"})(["svg{height:1rem;width:1rem;path{fill:",";}}"],(e=>{let{theme:t}=e;return t.colors.neutral600}));var W=()=>{const[e,t]=(0,n.useState)(!1),[a,r]=(0,n.useState)(!1),[l,M]=(0,n.useState)(!1),{changeLocale:P,localeNames:C}=(0,k.default)(),{setUserDisplayName:W}=(0,o.useAppInfos)(),q=(0,d.useQueryClient)(),{formatMessage:U}=(0,s.useIntl)(),{trackUsage:D}=(0,o.useTracking)(),B=(0,o.useNotification)(),{lockApp:N,unlockApp:F}=(0,o.useOverlayBlocker)(),{notifyStatus:H}=(0,b.useNotifyAT)(),{currentTheme:R,themes:V,onChangeTheme:z}=(0,_.useThemeToggle)();(0,o.useFocusWhenNavigate)();const{status:Q,data:Y}=(0,d.useQuery)("user",(()=>(0,I.fetchUser)()),{onSuccess:()=>{H(U({id:"Settings.profile.form.notify.data.loaded",defaultMessage:"Your profile data has been loaded"}))},onError:()=>{B({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}}),Z="success"!==Q,J=(0,d.useMutation)((e=>(0,I.putUser)(e)),{onSuccess:async e=>{await q.invalidateQueries("user"),o.auth.setUserInfo((0,f.default)(e,["email","firstname","lastname","username","preferedLanguage"]));const t=e.username||(0,x.getFullName)(e.firstname,e.lastname);W(t),P(e.preferedLanguage),z(e.currentTheme),D("didChangeMode",{newMode:e.currentTheme}),B({type:"success",message:{id:"notification.success.saved",defaultMessage:"Saved"}})},onSettled:()=>{F()},refetchActive:!0}),{isLoading:K}=J,X=(0,f.default)({...Y,currentTheme:R},["currentTheme","email","firstname","lastname","username","preferedLanguage"]);if(Z)return n.default.createElement(p.Main,{"aria-busy":"true"},n.default.createElement(c.Helmet,{title:U({id:"Settings.profile.form.section.helmet.title",defaultMessage:"User profile"})}),n.default.createElement(h.HeaderLayout,{title:U({id:"Settings.profile.form.section.profile.page.title",defaultMessage:"Profile page"})}),n.default.createElement(h.ContentLayout,null,n.default.createElement(o.LoadingIndicatorPage,null)));const $=Object.keys(V).filter((e=>V[e]));return n.default.createElement(p.Main,{"aria-busy":K},n.default.createElement(c.Helmet,{title:U({id:"Settings.profile.form.section.helmet.title",defaultMessage:"User profile"})}),n.default.createElement(i.Formik,{onSubmit:async(e,t)=>{let{setErrors:a}=t;N();const r=e.username||null;J.mutate({...e,username:r},{onError:e=>{var t;const r=null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.data;return null!==r&&void 0!==r&&r.data?a(r.data):B({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}})},initialValues:X,validateOnChange:!1,validationSchema:L.default,enableReinitialize:!0},(s=>{let{errors:i,values:d,handleChange:f,isSubmitting:c}=s;return n.default.createElement(o.Form,null,n.default.createElement(h.HeaderLayout,{title:Y.username||(0,x.getFullName)(Y.firstname,Y.lastname),primaryAction:n.default.createElement(w.Button,{startIcon:n.default.createElement(S.default,null),loading:c,type:"submit"},U({id:"global.save",defaultMessage:"Save"}))}),n.default.createElement(g.Box,{paddingBottom:10},n.default.createElement(h.ContentLayout,null,n.default.createElement(v.Stack,{spacing:6},n.default.createElement(g.Box,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},n.default.createElement(v.Stack,{spacing:4},n.default.createElement(m.Typography,{variant:"delta",as:"h2"},U({id:"global.profile",defaultMessage:"Profile"})),n.default.createElement(y.Grid,{gap:5},n.default.createElement(y.GridItem,{s:12,col:6},n.default.createElement(o.GenericInput,{intlLabel:{id:"Auth.form.firstname.label",defaultMessage:"First name"},error:i.firstname,onChange:f,value:d.firstname||"",type:"text",name:"firstname",required:!0})),n.default.createElement(y.GridItem,{s:12,col:6},n.default.createElement(o.GenericInput,{intlLabel:{id:"Auth.form.lastname.label",defaultMessage:"Last name"},error:i.lastname,onChange:f,value:d.lastname||"",type:"text",name:"lastname"})),n.default.createElement(y.GridItem,{s:12,col:6},n.default.createElement(o.GenericInput,{intlLabel:{id:"Auth.form.email.label",defaultMessage:"Email"},error:i.email,onChange:f,value:d.email||"",type:"email",name:"email",required:!0})),n.default.createElement(y.GridItem,{s:12,col:6},n.default.createElement(o.GenericInput,{intlLabel:{id:"Auth.form.username.label",defaultMessage:"Username"},error:i.username,onChange:f,value:d.username||"",type:"text",name:"username"}))))),n.default.createElement(g.Box,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},n.default.createElement(v.Stack,{spacing:4},n.default.createElement(m.Typography,{variant:"delta",as:"h2"},U({id:"global.change-password",defaultMessage:"Change password"})),n.default.createElement(y.Grid,{gap:5},n.default.createElement(y.GridItem,{s:12,col:6},n.default.createElement(T,{error:i.currentPassword?U({id:i.currentPassword,defaultMessage:i.currentPassword}):"",onChange:f,value:d.currentPassword||"",label:U({id:"Auth.form.currentPassword.label",defaultMessage:"Current Password"}),name:"currentPassword",type:l?"text":"password",endAction:n.default.createElement(G,{onClick:e=>{e.stopPropagation(),M((e=>!e))},label:U(l?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"})},l?n.default.createElement(O.default,null):n.default.createElement(j.default,null))}))),n.default.createElement(y.Grid,{gap:5},n.default.createElement(y.GridItem,{s:12,col:6},n.default.createElement(T,{error:i.password?U({id:i.password,defaultMessage:i.password}):"",onChange:f,value:d.password||"",label:U({id:"global.password",defaultMessage:"Password"}),name:"password",type:e?"text":"password",endAction:n.default.createElement(G,{onClick:e=>{e.stopPropagation(),t((e=>!e))},label:U(e?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"})},e?n.default.createElement(O.default,null):n.default.createElement(j.default,null))})),n.default.createElement(y.GridItem,{s:12,col:6},n.default.createElement(T,{error:i.confirmPassword?U({id:i.confirmPassword,defaultMessage:i.confirmPassword}):"",onChange:f,value:d.confirmPassword||"",label:U({id:"Auth.form.confirmPassword.label",defaultMessage:"Password confirmation"}),name:"confirmPassword",type:a?"text":"password",endAction:n.default.createElement(G,{onClick:e=>{e.stopPropagation(),r((e=>!e))},label:U(a?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"})},a?n.default.createElement(O.default,null):n.default.createElement(j.default,null))}))))),n.default.createElement(g.Box,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},n.default.createElement(v.Stack,{spacing:4},n.default.createElement(v.Stack,{spacing:1},n.default.createElement(m.Typography,{variant:"delta",as:"h2"},U({id:"Settings.profile.form.section.experience.title",defaultMessage:"Experience"})),n.default.createElement(m.Typography,null,U({id:"Settings.profile.form.section.experience.interfaceLanguageHelp",defaultMessage:"Preference changes will apply only to you. More information is available {here}."},{here:n.default.createElement(A,{target:"_blank",rel:"noopener noreferrer",href:"https://docs.strapi.io/developer-docs/latest/development/admin-customization.html#locales"},U({id:"Settings.profile.form.section.experience.documentation",defaultMessage:"here"}))}))),n.default.createElement(y.Grid,{gap:5},n.default.createElement(y.GridItem,{s:12,col:6},n.default.createElement(E.Select,{label:U({id:"Settings.profile.form.section.experience.interfaceLanguage",defaultMessage:"Interface language"}),placeholder:U({id:"global.select",defaultMessage:"Select"}),hint:U({id:"Settings.profile.form.section.experience.interfaceLanguage.hint",defaultMessage:"This will only display your own interface in the chosen language."}),onClear:()=>{f({target:{name:"preferedLanguage",value:null}})},clearLabel:U({id:"Settings.profile.form.section.experience.clear.select",defaultMessage:"Clear the interface language selected"}),value:d.preferedLanguage,onChange:e=>{f({target:{name:"preferedLanguage",value:e}})}},Object.keys(C).map((e=>{const t=C[e];return n.default.createElement(E.Option,{value:e,key:e},t)})))),n.default.createElement(y.GridItem,{s:12,col:6},n.default.createElement(E.Select,{label:U({id:"Settings.profile.form.section.experience.mode.label",defaultMessage:"Interface mode"}),placeholder:U({id:"components.Select.placeholder",defaultMessage:"Select"}),hint:U({id:"Settings.profile.form.section.experience.mode.hint",defaultMessage:"Displays your interface in the chosen mode."}),value:d.currentTheme,onChange:e=>{f({target:{name:"currentTheme",value:e}})}},$.map((e=>{const t=U({id:"Settings.profile.form.section.experience.mode.option-label",defaultMessage:"{name} mode"},{name:(0,u.default)(e)});return n.default.createElement(E.Option,{value:e,key:e},t)})))))))))))})))};t.default=W},91871:function(e,t,a){var r=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.putUser=t.fetchUser=void 0;var n=r(a(57557)),l=a(53777);t.fetchUser=async()=>{const{data:e}=await l.axiosInstance.get("/admin/users/me");return e.data};t.putUser=async e=>{const t=(0,n.default)(e,["confirmPassword","currentTheme"]),{data:a}=await l.axiosInstance.put("/admin/users/me",t);return{...a.data,currentTheme:e.currentTheme}}},32860:function(e,t,a){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var a=l(t);if(a&&a.has(e))return a.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=n?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,a&&a.set(e,r);return r}(a(53209)),n=a(37108);function l(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(l=function(e){return e?a:t})(e)}var o=r.object().shape(n.profileValidation);t.default=o},33694:function(e,t,a){var r=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var a=s(t);if(a&&a.has(e))return a.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var o=n?Object.getOwnPropertyDescriptor(e,l):null;o&&(o.get||o.set)?Object.defineProperty(r,l,o):r[l]=e[l]}r.default=e,a&&a.set(e,r);return r}(a(53209)),l=a(21600),o=r(a(20703));function s(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(s=function(e){return e?a:t})(e)}var i=n.object().shape({...l.commonUserSchema,isActive:n.bool(),...o.default});t.default=i},37108:function(e,t,a){var r=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"editValidation",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"profileValidation",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"rolesValidation",{enumerable:!0,get:function(){return o.default}});var n=r(a(33694)),l=r(a(21600)),o=r(a(20703))},21600:function(e,t,a){Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.commonUserSchema=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var a=l(t);if(a&&a.has(e))return a.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=n?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,a&&a.set(e,r);return r}(a(53209)),n=a(68547);function l(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(l=function(e){return e?a:t})(e)}const o={firstname:r.mixed().required(n.translatedErrors.required),lastname:r.mixed(),email:r.string().email(n.translatedErrors.email).lowercase().required(n.translatedErrors.required),username:r.string().nullable(),password:r.string().min(8,n.translatedErrors.minLength).matches(/[a-z]/,"components.Input.error.contain.lowercase").matches(/[A-Z]/,"components.Input.error.contain.uppercase").matches(/\d/,"components.Input.error.contain.number"),confirmPassword:r.string().min(8,n.translatedErrors.minLength).oneOf([r.ref("password"),null],"components.Input.error.password.noMatch").when("password",((e,t)=>e?t.required(n.translatedErrors.required):t))};t.commonUserSchema=o;var s={...o,currentPassword:r.string().when(["password","confirmPassword"],((e,t,a)=>e||t?a.required(n.translatedErrors.required):a)),preferedLanguage:r.string().nullable()};t.default=s},20703:function(e,t,a){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var a=l(t);if(a&&a.has(e))return a.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=n?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}r.default=e,a&&a.set(e,r);return r}(a(53209)),n=a(68547);function l(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(l=function(e){return e?a:t})(e)}var o={roles:r.array().min(1,n.translatedErrors.required).required(n.translatedErrors.required)};t.default=o}}]);