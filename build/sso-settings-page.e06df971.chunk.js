"use strict";(self.webpackChunkstrapi_sqlite=self.webpackChunkstrapi_sqlite||[]).push([[302],{66554:function(e,t,a){var l=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.SingleSignOn=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var a=O(t);if(a&&a.has(e))return a.get(e);var l={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var o=n?Object.getOwnPropertyDescriptor(e,r):null;o&&(o.get||o.set)?Object.defineProperty(l,r,o):l[r]=e[r]}l.default=e,a&&a.set(e,l);return l}(a(53547)),r=a(68547),o=l(a(22754)),i=a(35395),s=a(64459),u=a(80117),d=a(9524),f=a(33483),c=a(53575),g=a(2632),p=a(39272),m=a(97132),b=l(a(18446)),h=a(26595),v=a(63376),S=l(a(13240)),y=l(a(46718));function O(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(O=function(e){return e?a:t})(e)}const R={...S.default.settings.sso,readRoles:S.default.settings.roles.read},M=()=>{const{formatMessage:e}=(0,m.useIntl)(),{isLoading:t,allowedActions:{canUpdate:a,canReadRoles:l}}=(0,r.useRBAC)(R),[{formErrors:S,initialData:O,isLoading:M,modifiedData:E,showHeaderButtonLoader:w},k,{handleChange:P,handleSubmit:j}]=(0,v.useSettingsForm)((0,h.getRequestUrl)("providers/options"),y.default,(()=>{}),["autoRegister","defaultRole"]),{roles:C}=(0,v.useRolesList)(l);(0,r.useFocusWhenNavigate)();const L=t||M;(0,n.useEffect)((()=>{if(S.defaultRole){const e='[name="defaultRole"]';document.querySelector(e).focus()}}),[S]);const _=(0,b.default)(O,E);return n.default.createElement(i.Layout,null,n.default.createElement(r.SettingsPageTitle,{name:"SSO"}),n.default.createElement(u.Main,{tabIndex:-1},n.default.createElement("form",{onSubmit:e=>{_?e.preventDefault():j(e)}},n.default.createElement(i.HeaderLayout,{primaryAction:n.default.createElement(s.Button,{"data-testid":"save-button",disabled:_,loading:w,startIcon:n.default.createElement(o.default,null),type:"submit",size:"L"},e({id:"global.save",defaultMessage:"Save"})),title:e({id:"Settings.sso.title",defaultMessage:"Single Sign-On"}),subtitle:e({id:"Settings.sso.description",defaultMessage:"Configure the settings for the Single Sign-On feature."})}),n.default.createElement(i.ContentLayout,null,L?n.default.createElement(r.LoadingIndicatorPage,null):n.default.createElement(d.Stack,{spacing:4,background:"neutral0",padding:6,shadow:"filterShadow",hasRadius:!0},n.default.createElement(f.Typography,{variant:"delta",as:"h2"},e({id:"global.settings",defaultMessage:"Settings"})),n.default.createElement(p.Grid,{gap:4},n.default.createElement(p.GridItem,{col:6,m:6,s:12},n.default.createElement(c.ToggleInput,{"aria-label":"autoRegister","data-testid":"autoRegister",disabled:!a,checked:E.autoRegister,hint:e({id:"Settings.sso.form.registration.description",defaultMessage:"Create new user on SSO login if no account exists"}),label:e({id:"Settings.sso.form.registration.label",defaultMessage:"Auto-registration"}),name:"autoRegister",offLabel:e({id:"app.components.ToggleCheckbox.off-label",defaultMessage:"Off"}),onLabel:e({id:"app.components.ToggleCheckbox.on-label",defaultMessage:"On"}),onChange:e=>{P({target:{name:"autoRegister",value:e.target.checked}})}})),n.default.createElement(p.GridItem,{col:6,m:6,s:12},n.default.createElement(g.Select,{disabled:!a,hint:e({id:"Settings.sso.form.defaultRole.description",defaultMessage:"It will attach the new authenticated user to the selected role"}),error:S.defaultRole?e({id:S.defaultRole.id,defaultMessage:S.defaultRole.id}):"",label:e({id:"Settings.sso.form.defaultRole.label",defaultMessage:"Default role"}),name:"defaultRole",onChange:e=>{P({target:{name:"defaultRole",value:e}})},placeholder:e({id:"components.InputSelect.option.placeholder",defaultMessage:"Choose here"}),value:E.defaultRole},C.map((e=>{let{id:t,name:a}=e;return n.default.createElement(g.Option,{key:t,value:t.toString()},a)}))))))))))};t.SingleSignOn=M;var E=()=>n.default.createElement(r.CheckPagePermissions,{permissions:R.main},n.default.createElement(M,null));t.default=E},46718:function(e,t,a){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=a(68547),n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var a=r(t);if(a&&a.has(e))return a.get(e);var l={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var i=n?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(l,o,i):l[o]=e[o]}l.default=e,a&&a.set(e,l);return l}(a(53209));function r(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(r=function(e){return e?a:t})(e)}var o=n.object().shape({autoRegister:n.bool().required(l.translatedErrors.required),defaultRole:n.mixed().when("autoRegister",((e,t)=>e?t.required(l.translatedErrors.required):t.nullable()))});t.default=o}}]);