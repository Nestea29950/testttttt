(self.webpackChunkstrapi_sqlite=self.webpackChunkstrapi_sqlite||[]).push([[92],{699:function(e,t,a){var n;e.exports=(n=a(53547),function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=100)}({0:function(e,t){e.exports=n},100:function(e,t,a){"use strict";a.r(t);var n=a(0);function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}t.default=function(e){return n.createElement("svg",r({width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),n.createElement("path",{d:"M17 14h-4.34a6 6 0 110-4H23v4h-2v4h-4v-4zM7 14a2 2 0 100-4 2 2 0 000 4z",fill:"#8E8EA9"}))}}}))},87071:function(e,t,a){"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var a=f(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}n.default=e,a&&a.set(e,n);return n}(a(53547)),o=a(97132),i=a(68547),l=a(49549),s=n(a(54279)),u=n(a(45697)),d=a(74855),c=n(a(699));function f(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(f=function(e){return e?a:t})(e)}const p=e=>{let{apiToken:t}=e;const{formatMessage:a}=(0,o.useIntl)(),n=(0,i.useNotification)(),{trackUsage:u}=(0,i.useTracking)(),f=(0,r.useRef)(u);return r.default.createElement(i.ContentBox,{endAction:t&&r.default.createElement("span",{style:{alignSelf:"start"}},r.default.createElement(d.CopyToClipboard,{onCopy:()=>{f.current("didCopyTokenKey"),n({type:"success",message:{id:"Settings.apiTokens.notification.copied"}})},text:t},r.default.createElement(l.IconButton,{label:a({id:"app.component.CopyToClipboard.label",defaultMessage:"Copy to clipboard"}),noBorder:!0,icon:r.default.createElement(s.default,null),style:{padding:0,height:"1rem"}}))),title:t||a({id:"Settings.apiTokens.copy.editTitle",defaultMessage:"This token isn\u2019t accessible anymore."}),subtitle:a(t?{id:"Settings.apiTokens.copy.lastWarning",defaultMessage:"Make sure to copy this token, you won\u2019t be able to see it again!"}:{id:"Settings.apiTokens.copy.editMessage",defaultMessage:"For security reasons, you can only see your token once."}),icon:r.default.createElement(c.default,null),iconBackground:"neutral100"})};p.defaultProps={apiToken:null},p.propTypes={apiToken:u.default.string};var g=p;t.default=g},9461:function(e,t,a){"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a(53547)),o=a(68547),i=a(35395),l=a(80117),s=a(64459),u=n(a(22754)),d=a(97132),c=n(a(45697));const f=e=>{let{apiTokenName:t}=e;const{formatMessage:a}=(0,d.useIntl)();return(0,o.useFocusWhenNavigate)(),r.default.createElement(l.Main,{"aria-busy":"true"},r.default.createElement(o.SettingsPageTitle,{name:"API Tokens"}),r.default.createElement(i.HeaderLayout,{primaryAction:r.default.createElement(s.Button,{disabled:!0,startIcon:r.default.createElement(u.default,null),type:"button",size:"L"},a({id:"global.save",defaultMessage:"Save"})),title:t||a({id:"Settings.apiTokens.createPage.title",defaultMessage:"Create API Token"})}),r.default.createElement(i.ContentLayout,null,r.default.createElement(o.LoadingIndicatorPage,null)))};f.defaultProps={apiTokenName:null},f.propTypes={apiTokenName:c.default.string};var p=f;t.default=p},91486:function(e,t,a){"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var a=_(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var i=r?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}n.default=e,a&&a.set(e,n);return n}(a(53547)),o=a(97132),i=a(68547),l=a(35395),s=a(80117),u=a(64459),d=n(a(22754)),c=n(a(87760)),f=a(56156),p=a(80831),g=a(9524),y=a(94117),m=a(33483),v=a(39272),k=a(99136),b=a(78607),E=a(2632),T=n(a(27361)),M=a(39711),h=a(23724),O=a(26595),P=a(53777),w=n(a(93004)),j=n(a(9461)),S=n(a(87071));function _(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(_=function(e){return e?a:t})(e)}var C=()=>{var e,t,a,n;let _;(0,i.useFocusWhenNavigate)();const{formatMessage:C}=(0,o.useIntl)(),{lockApp:x,unlockApp:I}=(0,i.useOverlayBlocker)(),A=(0,i.useNotification)(),B=(0,M.useHistory)(),{trackUsage:W}=(0,i.useTracking)(),L=(0,r.useRef)(W),{setCurrentStep:N}=(0,i.useGuidedTour)(),{params:{id:D}}=(0,M.useRouteMatch)("/settings/api-tokens/:id"),F="create"===D;(0,r.useEffect)((()=>{L.current(F?"didAddTokenFromList":"didEditTokenFromList")}),[F]),null!==(e=B.location.state)&&void 0!==e&&e.apiToken.accessKey&&(_=B.location.state.apiToken);const{status:q,data:R}=(0,h.useQuery)(["api-token",D],(async()=>{const{data:{data:e}}=await P.axiosInstance.get(`/admin/api-tokens/${D}`);return e}),{enabled:!F&&!_,onError:()=>{A({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}});R&&(_=R);var G;return F||_||"success"===q?r.default.createElement(s.Main,null,r.default.createElement(i.SettingsPageTitle,{name:"API Tokens"}),r.default.createElement(p.Formik,{validationSchema:w.default,validateOnChange:!1,initialValues:{name:(null===(t=_)||void 0===t?void 0:t.name)||"",description:(null===(a=_)||void 0===a?void 0:a.description)||"",type:(null===(n=_)||void 0===n?void 0:n.type)||"read-only"},onSubmit:async(e,t)=>{L.current(F?"willCreateToken":"willEditToken"),x();try{const{data:{data:t}}=F?await P.axiosInstance.post("/admin/api-tokens",e):await P.axiosInstance.put(`/admin/api-tokens/${D}`,e);_=t,A({type:"success",message:C({id:"notification.success.saved",defaultMessage:"Saved"})}),L.current(F?"didCreateToken":"didEditToken",{type:_.type}),F&&(B.replace(`/settings/api-tokens/${t.id}`,{apiToken:t}),N("apiTokens.success"))}catch(a){const e=(0,O.formatAPIErrors)(a.response.data);t.setErrors(e),A({type:"warning",message:(0,T.default)(a,"response.data.message","notification.error")})}I()}},(e=>{var t,a,n,o,s;let{errors:p,handleChange:T,isSubmitting:M,values:h}=e;return r.default.createElement(i.Form,null,r.default.createElement(l.HeaderLayout,{title:(null===(t=_)||void 0===t?void 0:t.name)||C({id:"Settings.apiTokens.createPage.title",defaultMessage:"Create API Token"}),primaryAction:r.default.createElement(u.Button,{disabled:M,loading:M,startIcon:r.default.createElement(d.default,null),type:"submit",size:"L"},C({id:"global.save",defaultMessage:"Save"})),navigationAction:r.default.createElement(f.Link,{startIcon:r.default.createElement(c.default,null),to:"/settings/api-tokens"},C({id:"global.back",defaultMessage:"Back"}))}),r.default.createElement(l.ContentLayout,null,r.default.createElement(g.Stack,{spacing:6},Boolean(null===(a=_)||void 0===a?void 0:a.name)&&r.default.createElement(S.default,{apiToken:_.accessKey}),r.default.createElement(y.Box,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},r.default.createElement(g.Stack,{spacing:4},r.default.createElement(m.Typography,{variant:"delta",as:"h2"},C({id:"global.details",defaultMessage:"Details"})),r.default.createElement(v.Grid,{gap:5},r.default.createElement(v.GridItem,{key:"name",col:6,xs:12},r.default.createElement(k.TextInput,{name:"name",error:p.name?C(null!==(n=p.name)&&void 0!==n&&n.id?p.name:{id:p.name,defaultMessage:p.name}):null,label:C({id:"Settings.apiTokens.form.name",defaultMessage:"Name"}),onChange:T,value:h.name,required:!0})),r.default.createElement(v.GridItem,{key:"description",col:6,xs:12},r.default.createElement(b.Textarea,{label:C({id:"Settings.apiTokens.form.description",defaultMessage:"Description"}),name:"description",error:p.description?C(null!==(o=p.description)&&void 0!==o&&o.id?p.description:{id:p.description,defaultMessage:p.description}):null,onChange:T},h.description)),r.default.createElement(v.GridItem,{key:"type",col:6,xs:12},r.default.createElement(E.Select,{name:"type",label:C({id:"Settings.apiTokens.form.type",defaultMessage:"Token type"}),value:h.type,error:p.type?C(null!==(s=p.type)&&void 0!==s&&s.id?p.type:{id:p.type,defaultMessage:p.type}):null,onChange:e=>{T({target:{name:"type",value:e}})}},r.default.createElement(E.Option,{value:"read-only"},C({id:"Settings.apiTokens.types.read-only",defaultMessage:"Read-only"})),r.default.createElement(E.Option,{value:"full-access"},C({id:"Settings.apiTokens.types.full-access",defaultMessage:"Full access"}))))))))))}))):r.default.createElement(j.default,{apiTokenName:null===(G=_)||void 0===G?void 0:G.name})};t.default=C},93004:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var a=o(t);if(a&&a.has(e))return a.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var l=r?Object.getOwnPropertyDescriptor(e,i):null;l&&(l.get||l.set)?Object.defineProperty(n,i,l):n[i]=e[i]}n.default=e,a&&a.set(e,n);return n}(a(53209)),r=a(68547);function o(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(o=function(e){return e?a:t})(e)}var i=n.object().shape({name:n.string(r.translatedErrors.string).required(r.translatedErrors.required),type:n.string(r.translatedErrors.string).oneOf(["read-only","full-access"]).required(r.translatedErrors.required),description:n.string().nullable()});t.default=i},70593:function(e,t,a){"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a(53547)),o=a(68547),i=n(a(13240)),l=n(a(91486));var s=()=>r.default.createElement(o.CheckPagePermissions,{permissions:i.default.settings["api-tokens"].update},r.default.createElement(l.default,null));t.default=s}}]);